version: 1.2.0.{build}

branches:
  only:
    - master

skip_tags: true

cache:
  - packages -> **\packages.config

configuration: Release

assembly_info:
  patch: true
  file: AssemblyInfo.*
  assembly_version: "{version}"
  assembly_file_version: "{version}"
  assembly_informational_version: "{version}"

build:
  parallel: true
  verbosity: minimal

before_build:
- nuget restore

after_build:
- nuget pack Core\Suigetsu.Core\Suigetsu.Core.nuspec -Version %appveyor_build_version%
- appveyor PushArtifact Suigetsu.Core.%appveyor_build_version%.nupkg

- nuget pack Core\Suigetsu.Core.Desktop\Suigetsu.Core.Desktop.nuspec -Version %appveyor_build_version%
- appveyor PushArtifact Suigetsu.Core.Desktop.%appveyor_build_version%.nupkg

deploy:
  provider: NuGet
  api_key:
    secure: 1VWw9N4l/dx9R+6jI8NkwAtS5uZZOvtFx78s3o4hUb9+xppT0iEB+Y/FcuVXOzHK
  artifact: /.*\.nupkg/
